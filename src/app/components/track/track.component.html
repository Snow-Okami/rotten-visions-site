<div class="content-wrapper">
  <div class="body">

    <!-- LATEST POSTS APPEARS HERE -->
    <div class="row">
      <div class="col w100">
        <div class="update-tab"> USER DETAILS </div>
        <mat-divider></mat-divider>

        <!-- Repeat should be here -->
        <ul>
          <li class="row">
            <div class="col w100" [@openClose]="displayedColumns?.length ? 'closed' : 'open'">
              <p class="t-al-center pg-bg"> Checking for details... </p>
            </div>
            <div class="col w100" [@openClose]="!displayedColumns?.length ? 'closed' : 'open'">

              <mat-form-field>
                <input matInput (keyup)="applyFilter($event.target.value)" placeholder="Filter">
              </mat-form-field>

              <table mat-table matSort
                [dataSource]="dataSource" multiTemplateDataRows
                class="mat-elevation-z8">
                <ng-container matColumnDef="{{column}}" *ngFor="let column of displayedColumns">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header
                    [ngClass]="{
                      'w5': ['emailValidated', 'allowedToAccess'].includes(column),
                      'w10': ['id', 'firstName', 'lastName'].includes(column),
                      'w15': ['username'].includes(column),
                      'w20': ['email'].includes(column)
                    }"> {{column | titlecase}} </th>
                  <td mat-cell *matCellDef="let element"
                    [ngClass]="{
                      'w5': ['emailValidated', 'allowedToAccess'].includes(column),
                      'w10': ['id', 'firstName', 'lastName'].includes(column),
                      'w15': ['username'].includes(column),
                      'w20': ['email'].includes(column)
                    }"> {{element[column]}} </td>
                </ng-container>
              
                <!-- Expanded Content Column - The detail row is made up of this one column that spans across all columns -->
                <ng-container matColumnDef="expandedDetail">
                  <td mat-cell *matCellDef="let element" [attr.colspan]="displayedColumns.length">
                    <div class="example-element-detail"
                      [@detailExpand]="element === expandedElement ? 'expanded' : 'collapsed'">
                      <ul>
                        <li class="row">
                            <!-- <div class="col w100 p-t-5 p-b-5"> DB Id: {{element._id}} </div> -->
                            <div class="col w100 p-t-5 p-b-5"> Email: {{element?.email}} </div>
                            <div class="col w100 p-t-5 p-b-5"> Name: {{element?.fullName}} </div>
                            <div class="col w100 p-t-5 p-b-5"> User Id: {{element?.id}} </div>
                            <div class="col w100 p-t-5 p-b-5"> Username: {{element?.username}} </div>
                            <div class="col w100 p-t-5 p-b-5"> Capability:
                              <mat-radio-group aria-label="Choose your type" value="{{element?.capability}}" [disabled]="(store.user.data['email'] === element?.email) || disableToggle" (change)="updateCapability($event, element, 'capability')">
                                <mat-radio-button value="1" class="m-r-10">Regular user</mat-radio-button>
                                <mat-radio-button value="2">Project admin</mat-radio-button>
                              </mat-radio-group>
                            </div>
                            <div class="col w100 p-t-5 p-b-5"> Email Validated: 
                              <mat-slide-toggle class="example-toggle" [color]="primary" [checked]="element.emailValidated" [disabled]="(store.user.data['email'] === element.email) || disableToggle" (change)="updatePermission($event, element, 'emailValidated')"></mat-slide-toggle>
                            </div>
                            <div class="col w100 p-t-5 p-b-5"> Allowed to Access:
                              <mat-slide-toggle class="example-toggle" [color]="primary" [checked]="element.allowedToAccess" [disabled]="(store.user.data['email'] === element.email) || disableToggle" (change)="updatePermission($event, element, 'allowedToAccess')"></mat-slide-toggle>
                            </div>
                          <!-- <mat-divider></mat-divider> -->
                        </li>
                      </ul>

                    </div>
                  </td>
                </ng-container>
              
                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let element; columns: displayedColumns;"
                    class="example-element-row"
                    [class.example-expanded-row]="expandedElement === element"
                    (click)="expandedElement = expandedElement === element ? null : element">
                </tr>
                <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="example-detail-row"></tr>
              </table>

              <mat-paginator [pageSizeOptions]="[10, 25, 50, 100]"></mat-paginator>
            </div>
          </li>
        </ul>

      </div>
    </div>
    
  </div>
</div>
